CREATE SCHEMA JOINS;
USE JOINS;

CREATE TABLE OTT_PLATFORM(
OTT_ID INT PRIMARY KEY,
OTT_NAME VARCHAR(20) NOT NULL ,
SUBSCRIPTION VARCHAR(20),
LANGUAGE VARCHAR(30)
);

INSERT INTO OTT_PLATFORM VALUES (1, 'NETFLIX', '3MONTHS', 'HINDI');
INSERT INTO OTT_PLATFORM VALUES (2, 'ZEE5', '6MONTHS', 'KANNADA');
INSERT INTO OTT_PLATFORM VALUES (3, 'JIO', '8MONTHS', 'TELAGU');
INSERT INTO OTT_PLATFORM VALUES (4, 'PRIME', '6MONTHS', 'MARATHI');
INSERT INTO OTT_PLATFORM VALUES (5, 'VOOT', '9MONTHS', 'TAMIL');
INSERT INTO OTT_PLATFORM VALUES (6, 'HOTSTAR', '9MONTHS', 'MALAYALAM');
INSERT INTO OTT_PLATFORM VALUES (7, 'HULU', '4MONTHS', 'ENGLISH');

CREATE TABLE USER_DETAILS(
USER_ID INT PRIMARY KEY ,
OTT_ID INT NOT NULL UNIQUE,
USER_NAME VARCHAR(20)NOT NULL,
MAIL_ID VARCHAR(15) UNIQUE,
FOREIGN KEY (OTT_ID) REFERENCES OTT_PLATFORM (OTT_ID)
);
SELECT * FROM USER_DETAILS;
ALTER TABLE USER_DETAILS MODIFY MAIL_ID VARCHAR(30);
INSERT INTO USER_DETAILS VALUES (10, 1, 'DISHA', 'disha@gmail.com');
INSERT INTO USER_DETAILS VALUES (20, 2, 'vivek', 'vivek@gmail.com');
INSERT INTO USER_DETAILS VALUES (30, 3, 'REDDY', 'reddy@gmail.com');
INSERT INTO USER_DETAILS VALUES (40, 4, 'PURUSH', 'purush@gmail.com');
INSERT INTO USER_DETAILS VALUES (50, 5, 'CHETAN', 'chetan@gmail.com');
INSERT INTO USER_DETAILS VALUES (60, 6, 'VIDYA', 'VIDYA@gmail.com');
INSERT INTO USER_DETAILS VALUES (70, 7, 'SNEHA', 'SNEHA@gmail.com');
INSERT INTO USER_DETAILS VALUES (80, 8, 'VAISH', 'VAISH@gmail.com');

CREATE TABLE FOUNDER_DETAILS(
FOUNDER_ID INT PRIMARY KEY,
FOUNDER_NAME VARCHAR(30),
USER_ID INT ,
FOUNDER_MAIL_ID VARCHAR(20),
FOREIGN KEY (USER_ID) REFERENCES  USER_DETAILS (USER_ID)
);
SELECT * FROM FOUNDER_DETAILS;
ALTER TABLE FOUNDER_DETAILS DROP constraint FOUNDER_DETAILS_USER_ID_FK ;
ALTER TABLE FOUNDER_DETAILS ADD COLUMN OTT_ID INT ;

ALTER TABLE FOUNDER_DETAILS ADD FOREIGN KEY (OTT_ID) REFERENCES OTT_PLATFORM (OTT_ID);


INSERT INTO FOUNDER_DETAILS VALUES (100 , 'NAVEEN', 10 , 'NAVEEN@GAMIL.COM');
INSERT INTO FOUNDER_DETAILS VALUES (200 , 'SIA', 20 , 'SIA@GAMIL.COM');
INSERT INTO FOUNDER_DETAILS VALUES (300 , 'ANVIT', 30 , 'ANVIT@GAMIL.COM');
INSERT INTO FOUNDER_DETAILS VALUES (400 , 'TEJU', 40 , 'TEJU@GAMIL.COM');
INSERT INTO FOUNDER_DETAILS VALUES (500 , 'JEEVAN', 50 , 'JEEVAN@GAMIL.COM');
INSERT INTO FOUNDER_DETAILS VALUES (700 , 'CHINNU', 70 , 'CHINNU@GAMIL.COM');

UPDATE FOUNDER_DETAILS SET OTT_ID = 1 WHERE FOUNDER_ID = 100;
UPDATE FOUNDER_DETAILS SET OTT_ID = 2 WHERE FOUNDER_ID = 200;
UPDATE FOUNDER_DETAILS SET OTT_ID = 3 WHERE FOUNDER_ID = 300;
UPDATE FOUNDER_DETAILS SET OTT_ID = 4 WHERE FOUNDER_ID = 400;
UPDATE FOUNDER_DETAILS SET OTT_ID = 5 WHERE FOUNDER_ID = 500;

SELECT * FROM OTT_PLATFORM AS OTT , USER_DETAILS AS USER , FOUNDER_DETAILS AS FOUNDER WHERE OTT.OTT_ID = USER.OTT_ID =  FOUNDER.OTT_ID;
SELECT * FROM OTT_PLATFORM AS OTT  inner join  USER_DETAILS AS USER inner join FOUNDER_DETAILS AS FOUNDER  ON ott.ott_id=user.ott_id AND ott.ott_id=founder.ott_id;
SELECT * FROM OTT_PLATFORM AS OTT LEFT JOIN USER_DETAILS AS USER ON OTT.OTT_ID= USER.OTT_ID WHERE USER_NAME = 'VIVEK';
SELECT * FROM OTT_PLATFORM AS OTT LEFT JOIN USER_DETAILS AS USER ON OTT.OTT_ID = USER.OTT_ID LEFT JOIN FOUNDER_DETAILS AS FOUNDER  ON OTT.OTT_ID = FOUNDER.OTT_ID;
SELECT * FROM OTT_PLATFORM AS OTT RIGHT JOIN USER_DETAILS AS USER ON OTT.OTT_ID = USER.OTT_ID ;
SELECT * FROM OTT_PLATFORM AS OTT RIGHT JOIN USER_DETAILS AS USER ON OTT.OTT_ID = USER.OTT_ID RIGHT JOIN  FOUNDER_DETAILS AS FOUNDER  ON OTT.OTT_ID = FOUNDER.OTT_ID;
SELECT * FROM OTT_PLATFORM AS OTT RIGHT JOIN FOUNDER_DETAILS AS FOUNDER ON OTT.OTT_ID = FOUNDER.OTT_ID;


SELECT distinct(OTT_ID)  FROM OTT_PLATFORM;
SELECT * FROM USER_DETAILS order by MAIL_ID;
SELECT * FROM USER_DETAILS order by MAIL_ID DESC;
SELECT * FROM FOUNDER_DETAILS LIMIT 2;

CREATE TABLE ORDER_EVENTS(
ORDER_ID INT PRIMARY KEY ,
EVENT_ID INT UNIQUE NOT NULL,
ORDER_DATE DATE,
EVENT_NAME VARCHAR(20) NOT NULL
);

INSERT INTO ORDER_EVENTS VALUES(1, 10, '2023-02-11', 'RECEPTION');
INSERT INTO ORDER_EVENTS VALUES(2, 20, '2023-03-12', 'MEHENDI');
INSERT INTO ORDER_EVENTS VALUES(3, 30, '2023-04-13', 'HALDI');
INSERT INTO ORDER_EVENTS VALUES(4, 40, '2023-05-14', 'SANGEET');
INSERT INTO ORDER_EVENTS VALUES(5, 50, '2023-06-15', 'BIRTHDAY');
INSERT INTO ORDER_EVENTS VALUES(6, 60, '2023-07-16', 'HOME');

CREATE TABLE CUSTOMER_DETAILS(
CUSTOIMER_ID INT PRIMARY KEY ,
CUSTOMER_NAME varchar(20) NOT NULL,
MAIL_ID VARCHAR(20) UNIQUE,
ORDER_ID INT ,
FOREIGN KEY (ORDER_ID) REFERENCES ORDER_EVENTS (ORDER_ID)
);

INSERT INTO CUSTOMER_DETAILS VALUES(100, 'CHINNU' , 'CHINNU@GMAIL.COM', 1);
INSERT INTO CUSTOMER_DETAILS VALUES(200, 'AKSHI' , 'AKSHI@GMAIL.COM', 2);
INSERT INTO CUSTOMER_DETAILS VALUES(300, 'SHRI' , 'SHRI@GMAIL.COM', 3);
INSERT INTO CUSTOMER_DETAILS VALUES(400, 'NANDU' , 'NANDU@GMAIL.COM', 4);
INSERT INTO CUSTOMER_DETAILS VALUES(500, 'VIDDI' , 'VIDDI@GMAIL.COM', 5);

CREATE TABLE ORDER_DETAILS(
ORDER_ID INT UNIQUE NOT NULL,
ORDER_DETAILS_ID INT PRIMARY KEY,
PRODUCT_NAME VARCHAR(20),
PRICE DOUBLE ,
QUANTITY INT ,
FOREIGN KEY (ORDER_ID) REFERENCES CUSTOMER_DETAILS  (ORDER_ID)
);

INSERT INTO ORDER_DETAILS VALUES (1, 1000, 'DECORATION' , 5000.00, 1);
INSERT INTO ORDER_DETAILS VALUES (2, 2000, 'FLOWERS' , 2000.00, 3);
INSERT INTO ORDER_DETAILS VALUES (3, 3000, 'CAKE' , 1000.00, 2);
INSERT INTO ORDER_DETAILS VALUES (4, 4000, 'RETURNGIFT' , 3000.00, 4);
INSERT INTO ORDER_DETAILS VALUES (5, 5000, 'JUICE' , 4000.00, 8);

SELECT * FROM ORDER_EVENTS AS EVENT INNER JOIN CUSTOMER_DETAILS AS CUSTOMER ON EVENT.ORDER_ID = CUSTOMER.ORDER_ID;   
SELECT * FROM ORDER_EVENTS AS EVENT INNER JOIN CUSTOMER_DETAILS AS CUSTOMER ON EVENT.ORDER_ID = CUSTOMER.ORDER_ID INNER JOIN ORDER_DETAILS AS DETAILS ON DETAILS.ORDER_ID = CUSTOMER.ORDER_ID;
SELECT * FROM ORDER_EVENTS AS EVENT RIGHT JOIN CUSTOMER_DETAILS AS CUSTOMER ON EVENT.ORDER_ID = CUSTOMER.ORDER_ID RIGHT JOIN ORDER_DETAILS AS DETAILS ON DETAILS.ORDER_ID = CUSTOMER.ORDER_ID;
SELECT * FROM ORDER_EVENTS AS EVENT LEFT JOIN CUSTOMER_DETAILS AS CUSTOMER ON EVENT.ORDER_ID = CUSTOMER.ORDER_ID LEFT JOIN ORDER_DETAILS AS DETAILS ON DETAILS.ORDER_ID = CUSTOMER.ORDER_ID;


SELECT DISTINCT(PRICE) FROM ORDER_DETAILS;
SELECT * FROM CUSTOMER_DETAILS ORDER BY CUSTOMER_NAME;
SELECT * FROM CUSTOMER_DETAILS ORDER BY CUSTOMER_NAME DESC;
SELECT * FROM ORDER_EVENTS LIMIT 3;




